{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Course Preview</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script> -->
</head>
<body>
    <!-- The table of content page  -->
<div class="row navbar-light bg-light mb-5 " style="border-bottom-left-radius: 35px;">
    
    <div class="col-9 col-lg-9 col-xl-9"> 
        <h1 class="fw-bold px-5"> Courses </h1>
    </div>
</div>


<div class="row d-flex justify-content-center align-items-center h-100 px-5" style="margin-top:1rem; margin-left: 2rem;">
    <div class="col">
        <div class="card text-black" style="border-radius: 25px;">
            <div class="card-body">
            <div class="row justify-content-center">
               
            <div class="row">
                <div class="col">
                   <a href=""> <button style=" border: 1px solid dodgerblue; " class="btn btn-light float-start"><img class="img-fluid" style="width: 50px; height: 50px; border-radius: 50%; border: 1px solid dodgerblue; "  src="https://img.icons8.com/clouds/100/undefined/back.png"/> Back </button></a>
                </div>
            </div>
            <div class="container shadow min-vh-100 py-2">
                <div class="container network_wrapper col-sm p-2 ">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title p-2">Content Uploading</h5>
                            <ul class="nav nav-tabs card-header-tabs nav-fill " data-bs-tabs="tabs">
                                <li class="nav-item">
                                    <a class="nav-link active" aria-current="true" data-bs-toggle="tab" href="#topic">Topic</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link " aria-current="true" data-bs-toggle="tab" href="#notes">Notes</a>
                                </li>
              
                                <li class="nav-item">
                                    <a class="nav-link" data-bs-toggle="tab" href="#pdf">PDF/Text</a>
                                </li>
              
                                <li class="nav-item">
                                  <a class="nav-link" data-bs-toggle="tab" href="#audio">Audio</a>
                                </li>
              
                                <li class="nav-item">
                                  <a class="nav-link" data-bs-toggle="tab" href="#video">Video</a>
                                </li>
                            </ul>
              
                        </div>
                        
                        <form class="card-body tab-content " style="height:inherit"  action="" method="post" enctype="multipart/form-data">
                          
                          {% csrf_token %}
                           

                          <div style="text-align:center ;" class="tab-pane active my-5" id="topic" role="tabpanel" aria-labelledby="home-tab">
                            <h3 class="py-5"><img src="https://img.icons8.com/clouds/100/undefined/place-marker.png"/> Topic</h3>
                            
                            <div class="d-flex flex-row align-items-center mb-4 ">
                                <i class="fa fa-suitcase fa-lg me-3 fa-fw"></i>
                                <div class="form-outline flex-fill mb-0">
                                    <input name="topic" style="color:black; font-weight:bold" type="text" class="form-control" value="{{ detailInfn.topic }}" disabled>
                                  </div>
                              </div>

                           
                          </div>


                            <div style="text-align:center ;" class="tab-pane  my-5" id="notes" role="tabpanel" aria-labelledby="home-tab">
                              <h3 > <span style="color:black; ">Uploaded Notes: </span> </h3>
                              <br>
                              <br>
                              <div style="border: 1px solid dodgerblue;">
                                 {{ detailInfn.notes|safe }} 
                               </div>
                              
                            </div>
                                
                           
                            <div  style="text-align:center ;" class="tab-pane m-5 p-5 " id="pdf" role="tabpanel" aria-labelledby="profile-tab">
                              <h3 > <span style="color:black; ">Uploaded Pdf: </span> </h3>
                      
                              <iframe src="{{ detailInfn.pdf.url }}" frameborder="0"></iframe>

                            </div>

                            <div style="width: 100% ; height:auto" class="tab-pane" id="audio" role="tabpanel" aria-labelledby="myPost-tab">
                              <h3 > <span style="color:black; ">Uploaded Audio: </span> </h3>
                                   
                              <h3 class="text-center" > <span style="color:black; ">  </span> <audio  class="m-2" controls src="{{detailInfn.audio.url }}"> </audio> </h3>
                                
                            </div>
    
              
                            <div  style="text-align:center ;"  class="tab-pane p-5 mt-2 mb-3" id="video" role="tabpanel" aria-labelledby="contact-tab">
                        
                                <h3 > <span style="color:black; ">Uploaded Video: </span> </h3>
                                
                                <video class="p-5" controls style="width: 100%;" src="{{detailInfn.video.url }}"></video>
                                
                               
                              
                              <br>
                             
                              <button  style="border: none; border-radius: 50%;" type="button" class=" p-5 m-5; text-align:center stopRec hiderForVideRecord"><img class="img-fluid" src="https://img.icons8.com/external-bearicons-outline-color-bearicons/64/undefined/external-stop-essential-collection-bearicons-outline-color-bearicons.png"/></button>  
                              <br>
                              <input class="btn btn-lg btn-success float-end" type="submit">
                            </div>
              
                            
                        </form>
                    </div>
                </div>
              </div>

            </div>
            </div>
        </div>
    </div> 
</div>


<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>


<script>
    var videDisplayArea = document.querySelector('.videoFeed')
    var startRecButton =  document.querySelector('.startRec')
    var stopRecButton =   document.querySelector('.stopRec')
   
    stopRecButton.style.display = "none";
    videDisplayArea.style.display = "none";
  
  
    const parts = []
    let mediaRecorder;
    let mystream = null 
   
  
    
  
  
  
     
        
  
        startRecButton.addEventListener('click', ()=>{
          navigator.mediaDevices.getUserMedia({audio:true, video:true}).then(stream=>{
          videDisplayArea.srcObject = stream; 
          mystream = stream
  
  
            mediaRecorder = new MediaRecorder(stream);
            mediaRecorder.start(1000);
            mediaRecorder.ondataavailable = function(e){
            parts.push(e.data);
            startRecButton.style.display = "none";
            stopRecButton.style.display = "inline-block";
            videDisplayArea.style.display = "inline-block";
          }
              
        });
  
  
       
    
  
    
  
      });
  
  
      stopRecButton.onclick = function(){
        mediaRecorder.stop()
  
        
          
  
        mystream.getTracks().forEach(function(track) {
          track.stop();
        });
        const blob = new Blob(parts , {
          type : "video/webm"
        });
        const url = URL.createObjectURL(blob);
        var currentdate = new Date();
        const anchor = document.createElement('a');
        // anchor.style  = "display: none";
        anchor.href = url
       
      
        anchor.download = "newRecordedFile" +  new Date().toLocaleString()+".webm";
        anchor.click();
  
        startRecButton.style.display = "block";
        stopRecButton.style.display = 'none';
        videDisplayArea.style.display = 'none';
  
  
    }
  
     
  
     
   
  </script>
  
  <!-- -------------------------------- js code for audio recording  ----------------------- -->
  <script type="text/javascript" src="https://code.jquery.com/jquery.min.js"></script>
  <script src="https://markjivko.com/dist/recorder.js"></script>
  <script>
      jQuery(document).ready(function () {
          var $ = jQuery;
          var myRecorder = {
              objects: {
                  context: null,
                  stream: null,
                  recorder: null
              },
              init: function () {
                  if (null === myRecorder.objects.context) {
                      myRecorder.objects.context = new (
                              window.AudioContext || window.webkitAudioContext
                              );
                  }
              },
              start: function () {
                  var options = {audio: true, video: false};
                  navigator.mediaDevices.getUserMedia(options).then(function (stream) {
                      myRecorder.objects.stream = stream;
                      myRecorder.objects.recorder = new Recorder(
                              myRecorder.objects.context.createMediaStreamSource(stream),
                              {numChannels: 1}
                      );
                      myRecorder.objects.recorder.record();
                  }).catch(function (err) {});
              },
              stop: function (listObject) {
                  if (null !== myRecorder.objects.stream) {
                      myRecorder.objects.stream.getAudioTracks()[0].stop();
                  }
                  if (null !== myRecorder.objects.recorder) {
                      myRecorder.objects.recorder.stop();
  
                      // Validate object
                      if (null !== listObject
                              && 'object' === typeof listObject
                              && listObject.length > 0) {
                          // Export the WAV file
                          myRecorder.objects.recorder.exportWAV(function (blob) {
                              var url = (window.URL || window.webkitURL)
                                      .createObjectURL(blob);
  
                              // Prepare the playback
                              var audioObject = $('<audio controls></audio>')
                                      .attr('src', url);
  
                              // Prepare the download link
                              var downloadObject = $('<a>&#9660;</a>')
                                      .attr('href', url)
                                      .attr('download', new Date().toUTCString() + '.wav');
  
                              // Wrap everything in a row
                              var holderObject = $('<div class="row"></div>')
                                      .append(audioObject)
                                      .append(downloadObject);
  
                              // Append to the list
                              listObject.append(holderObject);
                          });
                      }
                  }
              }
          };
  
          // Prepare the recordings list
          var listObject = $('[data-role="recordings"]');
  
          // Prepare the record button
          $('[data-role="controls"] > button').click(function () {
              // Initialize the recorder
              myRecorder.init();
  
              // Get the button state 
              var buttonState = !!$(this).attr('data-recording');
  
              // Toggle
              if (!buttonState) {
                  $(this).attr('data-recording', 'true');
                  myRecorder.start();
              } else {
                  $(this).attr('data-recording', '');
                  myRecorder.stop(listObject);
              }
          });
      });
  </script>
  <script>
    //  -------------- voice recoded button icon changer -------------------
    let count = 0;
  
    var cont = document.querySelector('.imgRecordings');
    var newNode  = document.createElement('img')
    newNode.src = "https://img.icons8.com/flat-round/64/undefined/stop.png"
  
    var recordNode = document.createElement('img')
    recordNode.src = "https://img.icons8.com/external-flaticons-flat-flat-icons/64/undefined/external-voice-recorder-press-and-media-flaticons-flat-flat-icons.png"
    cont.addEventListener('click',()=>{
  
      
      var anchortag = document.querySelector('.recordingds');
      
      if(count %2 == 0 ){
        cont.removeChild(cont.firstChild);
        cont.appendChild(newNode)
      }else{
        cont.removeChild(cont.firstChild);
        cont.appendChild(recordNode)
      }
      
      count++;
    });
  </script>
  
</body>
</html>







